<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Front-end developer Project 5">
    <!--link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"-->
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/style.css" media="screen" title="no title">
    <meta name="author" content="Paul Matencio">
    <title>Project 5 Neighborhood-Map</title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.0/knockout-min.js" async></script>
    <script type="text/javascript">
        // callback function when google Maps API is loaded
        var map,
        mapOptions = {
            center: {lat: 48.852729, lng: 2.350564},
            zoomControl: true,
            zoom: 14,
            minZoom: 2,
            maxZoom: 20,
            disableDefaultUI: true,
            streetViewControl: true
        },
        mapStyle = [{
            "featureType": "road.local",
            "elementType": "labels",
            "stylers": [{
                "hue": "#00a1ff"
            }, {
                "gamma": 0.8
            }]
            }, {
            "featureType": "road.highway",
            "stylers": [{
                "lightness": 12
            }, {
                "gamma": 1.31
            }, {
                "hue": "#ffa200"
            }]
            }, {
            "featureType": "landscape.natural"
            }];
        function initMap() {
            map = new google.maps.Map(document.querySelector('#map-canvas'), mapOptions);
            var styledMap = new google.maps.StyledMapType(mapStyle, {
                 name: "Styled Map"
            });
            map.mapTypes.set('map_style', styledMap);
            map.setMapTypeId('map_style');
            // append the app.js script  when the MAPS API is loaded
            (function(d) {
                var script = d.createElement('script');
                var s = d.scripts[d.scripts.length-1];
                script.src = 'js/app.js';
                script.async = true;
                s.parentNode.insertBefore(script, s.nextSibling);
            })(document);
        }
    </script>
    <script>
        (function (d) {
            var script = d.createElement('script');
            script.type = 'text/javascript';
            script.async = true;
            script.src = 'https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js';
            var s = d.scripts[0] ;
            s.parentNode.insertBefore(script, s);
        })(document);
    </script>
</head>

<body>
    <!--div tag that holds the google map-->
    <div id="map-canvas"></div>

    <!--  search box -->
    <div id="search-box" group="controls">
        <input id="search-input" type="text" data-bind="value: keyword, valueUpdate: 'afterkeydown', enterKey: getPlace" placeholder="Looking for places (separated by blank)  or :location ...">
    </div>
    <div group="hz-buttons">
        <button type="core" data-bind="click: $root.toggleLocation" class="hz-button">
            <span style="font-size: 24px;"> ⊕ </span>
        </button>
        <button type="core" data-bind="click: $root.toggleCategory" class="hz-button">
            <span style="font-size: 24px;"> ☰ </span>
        </button>
        <!--button type="core" data-bind="click: $root.resetIcons" class="hz-button">
             <span> ⚡⚡</span>
        </button-->
    </div>

    <div id="options" style="display: none;">
        <!-- location list-->
        <div data-bind="visible: $root.showLocation || Locations().length > 0">
            <div id="location" group="controls">
                <ul id="location-list" group="controls" data-bind="foreach: $root.filteredLocations">
                    <span data-bind="with:$parent.displayLocation($data)"></span>
                    <li data-bind="css:{selected:selected}">
                        <button class="destroy" data-bind="click: $root.removeLocation"></button>
                        <input class="toggle" data-bind="checked: $data.selected" type="checkbox">
                        <label data-bind="text: $data.name, event: { click: $root.selectLocation }"></label>
                    </li>
                </ul>
            </div>
        </div>
        <div class="mycategories" group="controls" data-bind="visible:$root.showCategory">
            <div class="select">
                <h3 style="background-color:#6890C1;padding:5px;color:white">Choose multiple categories</h3>
                <select style="padding:15px;" data-bind="options: mapPlaceTypes, selectedOptions: myCategories" size="15" multiple="true"></select>
            </div>
        </div>
        <!-- button to hide or show the search result list -->
        <div class="hide-result" group="controls">
            <button type="core" data-bind="click: $root.toggleResults">
                <span style="font-size: 24px;"> ☷ </span>
            </button>
        </div>

    </div>

    <!-- place search result -->
    <div class="results container-fluide" group="controls" data-bind="visible: $root.showResults">
        <div class="info-header row">
            <div class="col-md-2">
                <img src="images/info.jpg" alt="info">
            </div>
            <div class="col-xs-12 col-md-10">
                <h2 data-bind="text: $root.myCity"></h2>
            </div>
        </div>

        <!--ul class="infolist" data-bind="foreach: $root.myLocations"-->
        <ul class="infolist" data-bind="foreach: $root.filteredLocations">
            <span data-bind="foreach: $data.nearByPlaces">
                <li data-bind="click: $root.clickMarker">
                    <!-- picture -->
                    <div class="col-md-4">
                        <div data-bind="if: $data.photos">
                            <img class="list-photo" data-bind="attr:{src: photos[0].getUrl({maxWidth: 80})}" alt="place-photo">
                        </div>
                        <div data-bind="ifnot: $data.photos">
                            <img class="list-photo" src="images/nophoto.jpg" alt="no-photo">
                        </div>
                    </div>
                    <!-- end picture -->
                    <!-- place information-->
                    <div class="col-sm-12 col-md-8">
                        <h3 class="longtext" data-bind="text: $data.name"></h3>
                        <p class="place-category"><span data-bind="text: $root.formattedType($data)"></span></p>
                        <p>
                            <div data-bind="if: $data.rating">
                            <div>
                                <span class="rating-number" data-bind="text: $data.rating"></span>
                                <div style="display: inline;" data-bind="foreach: $root.rateStar($data.rating)">
                                    <img class="rate-star" data-bind="attr:{src: star}" alt="*">
                                </div>
                            </div>
                            </div>
                            <span data-bind="ifnot: $data.rating">
                                <em>no rating available.</em>
                            </span>
                        </p>
                        <p class="place-address"><span data-bind="text: $root.getAddress($data)"></span></p>
                    </div>
                <!-- end of place inforantion -->
                </li>
            </span>
        </ul>
        <div class="logo">
            <span>powered by </span>
            <img src="images/googlelogo.jpg" alt="Google" />
        </div>
    </div>
    <!-- Tools bar -->
    <div data-bind="visible: showResults">
        <div id="btn-toolbar" group="controls">
            <button type="core" class="btn" style="display: block" data-bind="click: $root.resetIcons">
                <span style="font-size: 24px;"> ↺ </span>
            </button>
            <div class="btn-group" data-bind="foreach: icons" role="group" aria-label="plane">
                <!--placeholder for filter buttons-->
                <button type="button" class="btn">
                    <img class="btn-toolbar-img" data-bind="click: $root.myIcons, attr: {src: icon}" alt="icon">
                </button>
                <br>
            </div>
            <button id="hide" type="core" class="btn" style="display: block">
                <span style="font-size:24px;">⊲</span>
            </button>
        </div>
    </div>
    <!-- end of place search result -->

    <!--Review page -->

    <div id="marker" style="display: none;">

        <div data-bind="visible: placeReviews().length">
            <div id="review-page" class="viewport">
                <button type="core" data-bind="click:$root.closeReview" class="navButton" group="closeButton" style="display: block">
                    <span style="font-size:24px;">⇦</span>
                </button>
                <div group="review-lists">
                    <div class="review-title" data-bind="with: placeInFocus">
                        <div class="longtext">
                            <span class="p2" data-bind="text: $data.name"></span>
                        </div>
                        <div style="float: left;">
                            <span class="rating-number" style="font-size: 16px;" data-bind="text: $data.rating"></span>
                            <div style="display: inline;" data-bind="foreach: $parent.rateStar($data.rating)">
                                <img style="height: 16px;" class="rate-star" data-bind="attr:{src: star}" alt="*">
                            </div>
                        </div>
                        <div class="greytext" data-bind="text: $data.formatted_address"> </div>
                    </div>
                    <ul class="list-review" data-bind="foreach: placeReviews">
                        <li>
                            <div>
                                <strong data-bind="text: $data.author_name"></strong>
                                <span class="rating-number" data-bind="text: $data.rating"></span>
                                <div style="display: inline;" data-bind="foreach: $parent.rateStar($data.rating)">
                                    <img class="rate-star" data-bind="attr:{src: star}" alt="*">
                                </div>
                            </div>
                            <div data-bind="text: $data.text"></div>
                        </li>
                    </ul>
                </div>
                <!-- container -->
            </div>
            <!-- viewport -->
        </div>
        <!--end review page -->

        <!-- Photos display -->
        <div id="photos-page" class="viewport" data-bind="visible: placePhotos().length">
            <button type="core" data-bind="click:$root.closePhoto" class="navButton" group="closeButton" style="display: block">
                <span style="font-size:24px;">⇦</span>
            </button>
            <div data-bind="with: currentPhoto">
                <img class="photo" data-bind="attr:{ src: getUrl({maxHeight: 800})}" alt="photo">
            </div>
            <div id="photoCounter">
                <span data-bind="text: photoIndex"></span>
                <span> / </span>
                <span data-bind="text: placePhotos().length"></span>
            </div>
            <button type="core" data-bind="click:$root.photoBackward" class="navButton" group="backward" style="display: block">
                <span style="font-size: 24px;">⊲</span>
            </button>
            <button type="core" data-bind="click:$root.photoForward" class="navButton" group="forward" style="display: block">
                <span style="font-size: 24px;">⊳</span>
            </button>
        </div>

        <!-- New york times page -->
        <div id="nytimes-page" class="viewport" data-bind="visible: nytarticles().length">
            <button type="core" data-bind="click:$root.closeNyt" class="navButton" group="closeButton" style="display: block">
                <span style="font-size:24px;">⇦</span>
            </button>

            <div class="Container" group="lists">
                <div class="review-title">
                    <span class="nytimes-header">New York Times Articles</span>
                    <span class="nytimes-header" data-bind="text:nytInFocus"></span>
                </div>
                <div class="mylist" data-bind="foreach: nytarticles">
                    <div>
                        <span class="article" style="padding:10px;" data-bind="html:$data"></span-->
                    </div>
                </div>
            </div>
        </div>
        <!--/div-->

        <!-- Wikipedia page -->
        <div id="wiki-page" class="viewport" data-bind="visible: wikiarticles().length">
            <button type="core" data-bind="click:$root.closeWiki" class="navButton" group="closeButton" style="display: block">
                  <span style="font-size:24px;">⇦</span>
            </button>
            <div class="Container" group="lists">
                <div class="review-title">
                    <span class="wiki-header">Wikipedia Articles</span>
                    <span class="wiki-header" data-bind="text:wikiInFocus"></span>
                </div>
                <div class="mylist" data-bind="foreach: wikiarticles">
                    <div>
                        <span class="article" style="padding: 5px;" data-bind="html:$data"></span>
                    </div>
                </div>
            </div>
        </div>
        <!-- street view page -->
        <div data-bind="visible: showView">
            <div id="street-page" class="viewport">
                <button type="core" data-bind="click:$root.closeView" class="navButton" group="closeButton" style="display: block">
                     <span style="font-size:24px;">⇦</span>
                </button>

                <div id="streeview">
                    <img class="street-view" data-bind="attr:{src: streetView, alt: noimage}">
                </div>
            </div>
        </div>
    </div>
    <!-- custom alert box -->
    <div id="alertoverlay"></div>
    <div id="alertbox">
        <div>
            <div id="alertboxhead"></div>
            <div id="alertboxbody"></div>
            <div id="alertboxfoot"></div>
        </div>
    </div>

    <!-- html templates for infowindow -->
    <script id="review-long" type="text/template" data-template="review-long">
        <div id="infoWindow" class="infoWindow">
            <p class="longtext"><h3>{{name}}</h3></p>
            <hr>
            <p class="longtext"><span>{{formatted_address}} </span></p>
            <p><span class="opening">{{opening}}</span></p>
            <div id="wiki" style="white-space: normal;"><span></span></div>
            <hr>{{rating}} {{photos}}
            <p><span>{{phone}} </span></p>
            <p><div class="longtext"><a class="longtext" href="{{website}}" target="_blank">{{website}}<a></div></p>
            <hr style="background: #ffbccd;">
            <img style="width: 20px;" src= "images/NYT-logo.png"><a href="#" id="nytLink" style="display: inline;"> NYT articles</a>
            <span style="font-size :20px; color:black; font-weight: bold;">&#87;</span>
            <a href="#" id="wikiLink" style="display: inline;"> Wikipedia articles</a>
            <img style="width: 20px;" src="images/streetview.png"><a href="#" id="streetLink" style="display: inline;">View</a>
        </div>
    </script>
    <script  id="review-short" type="text/template" data-template="review-short">
        <div id="infoWindow" class="infoWindow">
            <p class="longtext"> <h3>{{name}}</h3></p>
            <hr>
            <p class="longtext"><span>{{formatted_address}} </span></p>
            <div id="wiki" style="white-space: normal;"><span></span></div>
            <hr>{{rating}} {{photos}}
            <p><span>{{phone}} </span></p>
            <p><div class="longtext"><a class="longtext" href="{{website}}" target="_blank">{{website}}<a></div></p>
            <hr style="background: #ffbccd;">
            <span style="font-size :20px; color:black; font-weight: bold;">&#87;</span>
            <a href="#" id="wikiLink" style="display: inline;"> Wikipedia articles</a>
        </div>
    </script>

    <!-- template for newyork times page -->
    <script id="nytimes-temp" type="text/template" data-template="nytimes">
        <p class="article"><a href="{{articleUrl}}" target="_blank">{{headline}}</a></p>
    </script>
    <script id="wiki-temp" type="text/template" data-template="wiki">
        <p class="article"><a href="{{articleUrl}}" target="_blank">{{wikiarticle}}</p>
    </script>
    <script type="text/javascript">
      WebFontConfig = {
        google: {
        families: ['Roboto:100,300']
      }
      };
      (function(d) {
       var wf = d.createElement('script'), s = d.scripts[0];
       wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js';
       s.parentNode.insertBefore(wf, s);
      })(document);
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places&callback=initMap" async></script>
  </body>

</html>